# Email Workflow Visualization Guide
## OpenClaw Windows 10 AI Agent System

This document provides visual representations of the email workflow automation system architecture.

---

## 1. System Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              EMAIL WORKFLOW AUTOMATION ENGINE                                │
│                                    OpenClaw AI Agent System                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    INPUT LAYER                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │    Gmail     │  │   Outlook    │  │   IMAP/SMTP  │  │   Exchange   │  │   Webhook    │  │
│  │    API       │  │    API       │  │   Generic    │  │    EWS       │  │   Events     │  │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  │
│         └─────────────────┴─────────────────┴─────────────────┴─────────────────┘          │
│                                    │                                                         │
└────────────────────────────────────┼─────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                               INGESTION & NORMALIZATION LAYER                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐         │
│  │   MIME Parse    │→│   Normalize     │→│   Enrich        │→│   Validate      │         │
│  │   Extract       │  │   Encoding      │  │   Metadata      │  │   Schema        │         │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘         │
│                                    │                                                         │
└────────────────────────────────────┼─────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                  RULE ENGINE CORE                                            │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                              CONDITION EVALUATOR                                     │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌───────────┐  │    │
│  │  │   Sender    │  │   Subject   │  │   Content   │  │  Metadata   │  │    AI     │  │    │
│  │  │   Filters   │  │   Filters   │  │   Filters   │  │   Filters   │  │  Analysis │  │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └───────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                    │                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                              ACTION EXECUTOR                                         │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌───────────┐  │    │
│  │  │   Gmail     │  │  Response   │  │ Notification│  │   System    │  │    AI     │  │    │
│  │  │   Actions   │  │   Actions   │  │   Actions   │  │   Actions   │  │  Actions  │  │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └───────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────────────────────┘    │
│                                    │                                                         │
└────────────────────────────────────┼─────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                   OUTPUT LAYER                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │    Gmail     │  │   Twilio     │  │   Desktop    │  │   Browser    │  │   System     │  │
│  │   Actions    │  │  Voice/SMS   │  │   Notify     │  │   Control    │  │   Events     │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Rule Processing Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              EMAIL RULE PROCESSING PIPELINE                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    INPUT EMAIL
         │
         ▼
┌─────────────────┐
│  STAGE 1:       │
│  PRE-PROCESSING │
│                 │
│ • Parse MIME    │
│ • Normalize     │
│ • Extract       │
│   Metadata      │
│ • AI Analysis   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  STAGE 2:       │
│  RULE MATCHING  │
│                 │
│ • Filter by     │
│   Priority      │
│ • Evaluate      │
│   Conditions    │
│ • Score Rules   │
│ • Rank Matches  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  STAGE 3:       │
│  CONFLICT       │
│  RESOLUTION     │
│                 │
│ • Detect        │
│   Conflicts     │
│ • Apply         │
│   Strategy      │
│ • Optimize      │
│   Actions       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  STAGE 4:       │
│  ACTION         │
│  EXECUTION      │
│                 │
│ • Validate      │
│ • Execute       │
│ • Handle        │
│   Errors        │
│ • Log Results   │
└────────┬────────┘
         │
         ▼
    OUTPUT
    RESULTS
```

---

## 3. Auto-Responder Flow

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AUTO-RESPONDER DECISION FLOW                                    │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    NEW EMAIL
    RECEIVED
         │
         ▼
┌─────────────────┐     NO
│ Is Auto-Resp.   │────────► [Skip]
│   Enabled?      │
└────────┬────────┘
         │ YES
         ▼
┌─────────────────┐     NO
│ Check Exclusion │────────► [Skip]
│     Rules       │
│ (sender/domain/ │
│    subject)     │
└────────┬────────┘
         │ YES
         ▼
┌─────────────────┐     NO
│ Check Rate      │────────► [Skip]
│    Limits       │
└────────┬────────┘
         │ YES
         ▼
┌─────────────────┐     NO
│ Match Trigger   │────────► [Skip]
│  Conditions     │
└────────┬────────┘
         │ YES
         ▼
┌─────────────────┐
│  Apply Delay    │
│   (if set)      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Generate       │
│  Response       │
│                 │
│ ┌─────────────┐ │
│ │  Template   │ │
│ │   Match     │ │
│ └─────────────┘ │
│ ┌─────────────┐ │
│ │  AI-Gen     │ │
│ │  Response   │ │
│ └─────────────┘ │
│ ┌─────────────┐ │
│ │   Hybrid    │ │
│ │  Approach   │ │
│ └─────────────┘ │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   Send Email    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Update History │
│  & Analytics    │
└─────────────────┘
```

---

## 4. Template Engine Flow

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              TEMPLATE RENDERING PIPELINE                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    TEMPLATE
    REQUEST
         │
         ▼
┌─────────────────┐
│  Load Template  │
│   by ID/Name    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     FAIL
│ Validate Input  │────────► [Error]
│   Variables     │
└────────┬────────┘
         │ PASS
         ▼
┌─────────────────┐
│  Add Default    │
│   Variables     │
│                 │
│ • Current Date  │
│ • User Info     │
│ • System Info   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Apply Custom   │
│    Filters      │
│                 │
│ • format_date   │
│ • truncate      │
│ • quote         │
│ • ...           │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     YES
│ AI Enhancement  │────────────────┐
│   Enabled?      │                │
└────────┬────────┘                │
         │ NO                      │
         ▼                         ▼
┌─────────────────┐      ┌─────────────────┐
│  Render Final   │      │  AI Process &   │
│    Output       │      │   Enhance       │
└────────┬────────┘      └────────┬────────┘
         │                        │
         └──────────┬─────────────┘
                    │
                    ▼
         ┌─────────────────┐
         │  Return Rendered│
         │    Email (HTML  │
         │    + Text)      │
         └─────────────────┘
```

---

## 5. Conversation Thread Tracking

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                           CONVERSATION THREAD TRACKING                                       │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    NEW EMAIL
         │
         ▼
┌─────────────────┐
│  Extract Thread │
│     Headers     │
│                 │
│ • Gmail ID      │
│ • References    │
│ • In-Reply-To   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     NOT FOUND
│  Find Existing  │────────────────┐
│     Thread      │                │
└────────┬────────┘                │
    FOUND │                        │
         ▼                        ▼
┌─────────────────┐      ┌─────────────────┐
│  Add Message to │      │  Create New     │
│  Existing Thread│      │     Thread      │
└────────┬────────┘      └────────┬────────┘
         │                        │
         └──────────┬─────────────┘
                    │
                    ▼
         ┌─────────────────┐
         │  Update Thread  │
         │   Metadata      │
│                │
│ ┌──────────────┼──────────────┐
│ │              │              │
│ ▼              ▼              ▼
│┌──────┐  ┌──────────┐  ┌──────────┐
││Update│  │  Update  │  │  Update  │
││Participants│  │Timestamp │  │  Summary │
│└──────┘  └──────────┘  └──────────┘
│
└─────────────────┘
         │
         ▼
┌─────────────────┐
│  AI Analysis    │
│  (Optional)     │
│                 │
│ • Sentiment     │
│ • Action Items  │
│ • Summary       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Save Thread    │
│   to Storage    │
└─────────────────┘
```

---

## 6. Scheduled Email Workflow

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              SCHEDULED EMAIL WORKFLOW                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    SCHEDULING OPTIONS                                        │
│                                                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  One-Time    │  │   Recurring  │  │   Delayed    │  │   Cron       │  │  Conditional │  │
│  │   Specific   │  │   Daily/     │  │   Relative   │  │  Expression  │  │    Trigger   │  │
│  │    Date      │  │   Weekly     │  │    Time      │  │   Based      │  │   Based      │  │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  │
│         └─────────────────┴─────────────────┴─────────────────┴─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              SCHEDULER EXECUTION FLOW                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    SCHEDULE
    REQUEST
         │
         ▼
┌─────────────────┐
│  Parse Trigger  │
│   Definition    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Validate       │
│  Schedule       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Add to Job     │
│   Queue         │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Wait for       │
│  Trigger Time   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     FAIL
│  Render Email   │────────► [Retry/Error]
│   Template      │
└────────┬────────┘
         │ SUCCESS
         ▼
┌─────────────────┐     FAIL
│   Send Email    │────────► [Retry/Error]
│   via Gmail     │
└────────┬────────┘
         │ SUCCESS
         ▼
┌─────────────────┐
│  Update Status  │
│  & Log Result   │
└─────────────────┘
         │
         ▼
┌─────────────────┐     YES
│  Is Recurring?  │────────► [Reschedule]
└────────┬────────┘         [Next Occurrence]
         │ NO
         ▼
    [COMPLETE]
```

---

## 7. Visual Workflow Designer

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                           VISUAL WORKFLOW DESIGNER                                           │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              WORKFLOW CANVAS                                                 │
│                                                                                              │
│   ┌─────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐         │
│   │  START  │─────▶│  CHECK  │─────▶│  LABEL  │─────▶│ NOTIFY  │─────▶│  END    │         │
│   │ Trigger │      │  VIP?   │      │  ADD    │      │  USER   │      │         │         │
│   └─────────┘      └────┬────┘      └─────────┘      └─────────┘      └─────────┘         │
│                         │                                                                   │
│                         │ NO                                                                │
│                         ▼                                                                   │
│                    ┌─────────┐                                                              │
│                    │  CHECK  │                                                              │
│                    │  SPAM?  │                                                              │
│                    └────┬────┘                                                              │
│                         │                                                                   │
│                    ┌────┴────┐                                                              │
│                    │  YES    │ NO                                                            │
│                    ▼         ▼                                                              │
│               ┌────────┐  ┌────────┐                                                        │
│               │ TRASH  │  │ARCHIVE │                                                        │
│               └────────┘  └────────┘                                                        │
│                                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              NODE PALETTE                                                    │
│                                                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │  TRIGGERS   │  │ CONDITIONS  │  │   ACTIONS   │  │  FLOW CTRL  │  │ INTEGRATIONS│       │
│  │             │  │             │  │             │  │             │  │             │       │
│  │ • Email     │  │ • Filter    │  │ • Label     │  │ • Branch    │  │ • Calendar  │       │
│  │ • Scheduled │  │ • AI Check  │  │ • Move      │  │ • Loop      │  │ • Slack     │       │
│  │ • Manual    │  │ • Time      │  │ • Reply     │  │ • Merge     │  │ • Twilio    │       │
│  │ • Webhook   │  │ • Variable  │  │ • Notify    │  │ • Delay     │  │ • Webhook   │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. Integration Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              INTEGRATION ARCHITECTURE                                        │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              EMAIL WORKFLOW ENGINE                                           │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
         │
         │ Adapters
         ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              INTEGRATION LAYER                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │    Gmail     │  │   Twilio     │  │   Browser    │  │    TTS/      │  │   System     │  │
│  │   Adapter    │  │   Adapter    │  │   Control    │  │    STT       │  │   Events     │  │
│  │              │  │              │  │              │  │              │  │              │  │
│  │ • Read       │  │ • SMS        │  │ • Open URL   │  │ • Speak      │  │ • Notify     │  │
│  │ • Send       │  │ • Voice      │  │ • Scrape     │  │ • Listen     │  │ • Execute    │  │
│  │ • Label      │  │ • Call       │  │ • Click      │  │ • Transcribe │  │ • Schedule   │  │
│  │ • Search     │  │ • Message    │  │ • Form Fill  │  │ • Synthesize │  │ • Trigger    │  │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  │
│         │                 │                 │                 │                 │          │
└─────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┼──────────┘
          │                 │                 │                 │                 │
          ▼                 ▼                 ▼                 ▼                 ▼
  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
  │  Google API  │  │  Twilio API  │  │  Selenium/   │  │  Windows     │  │  Windows     │
  │              │  │              │  │  Playwright  │  │  Speech API  │  │  Task Sched. │
  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
```

---

## 9. Data Flow Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                               DATA FLOW                                                      │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    ┌──────────┐
    │  Gmail   │
    │  Server  │
    └────┬─────┘
         │ Fetch Emails
         ▼
    ┌──────────┐
    │  Email   │
    │  Ingest  │
    └────┬─────┘
         │ Parse & Normalize
         ▼
    ┌──────────┐
    │  Rule    │
    │  Engine  │
    └────┬─────┘
         │ Match & Execute
         ▼
    ┌──────────┐
    │  Action  │
    │  Queue   │
    └────┬─────┘
         │ Process Actions
         ▼
    ┌─────────────────────────────────────────┐
    │              OUTPUTS                    │
    │  ┌────────┐ ┌────────┐ ┌────────┐      │
    │  │ Gmail  │ │ Notify │ │ Store  │      │
    │  │ Actions│ │ Users  │ │ Data   │      │
    │  └────────┘ └────────┘ └────────┘      │
    └─────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              DATA STORES                                                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │    Rules     │  │  Templates   │  │   Threads    │  │  Analytics   │  │    Logs      │  │
│  │    Store     │  │    Store     │  │    Store     │  │    Store     │  │    Store     │  │
│  │              │  │              │  │              │  │              │  │              │  │
│  │ • Rule Defs  │  │ • Templates  │  │ • Convers.   │  │ • Metrics    │  │ • Audit      │  │
│  │ • Conditions │  │ • Variables  │  │ • Messages   │  │ • Reports    │  │ • Errors     │  │
│  │ • Actions    │  │ • CSS Styles │  │ • Summaries  │  │ • Trends     │  │ • Actions    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 10. Security & Compliance Flow

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                           SECURITY & COMPLIANCE                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

    INCOMING
    EMAIL
         │
         ▼
┌─────────────────┐
│  PHISHING       │     DETECTED
│  DETECTION      │────────────────┐
│  (AI + Rules)   │                │
└────────┬────────┘                │
    CLEAN │                        │
         ▼                        ▼
┌─────────────────┐      ┌─────────────────┐
│  ATTACHMENT     │      │  QUARANTINE     │
│  SCANNING       │      │  EMAIL          │
│                 │      │                 │
│ • File Type     │      │ • Add Label     │
│ • Size Check    │      │ • Notify Admin  │
│ • Malware Scan  │      │ • Log Event     │
└────────┬────────┘      └─────────────────┘
    CLEAN │
         ▼
┌─────────────────┐
│  CONTENT        │
│  FILTERING      │
│                 │
│ • PII Detection │
│ • Data Loss Prev│
│ • Policy Check  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  AUDIT LOG      │
│  RECORD         │
│                 │
│ • Timestamp     │
│ • Action        │
│ • Result        │
│ • User          │
└─────────────────┘
```

---

## 11. Complete System Interaction

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                    COMPLETE EMAIL WORKFLOW SYSTEM INTERACTION                                │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

  USER                    EMAIL WORKFLOW ENGINE                    EXTERNAL SERVICES
    │                             │                                       │
    │ 1. Configure Rules          │                                       │
    │────────────────────────────▶│                                       │
    │                             │                                       │
    │                             │ 2. Poll for New Emails                │
    │                             │──────────────────────────────────────▶│
    │                             │                                       │ Gmail API
    │                             │◀──────────────────────────────────────│
    │                             │                                       │
    │                             │ 3. Process Email                      │
    │                             │ ┌─────────────────┐                   │
    │                             │ │ • Parse         │                   │
    │                             │ │ • Enrich        │                   │
    │                             │ │ • Analyze (AI)  │                   │
    │                             │ └─────────────────┘                   │
    │                             │                                       │
    │                             │ 4. Match Rules                        │
    │                             │ ┌─────────────────┐                   │
    │                             │ │ • Evaluate      │                   │
    │                             │ │ • Score         │                   │
    │                             │ │ • Rank          │                   │
    │                             │ └─────────────────┘                   │
    │                             │                                       │
    │                             │ 5. Execute Actions                    │
    │                             │ ┌─────────────────┐                   │
    │                             │ │ • Label         │                   │
    │                             │ │ • Notify        │                   │
    │                             │ │ • Respond       │                   │
    │                             │ └─────────────────┘                   │
    │                             │                                       │
    │ 6. Notification (if urgent) │                                       │
    │◀────────────────────────────│                                       │
    │                             │                                       │
    │                             │ 7. Send Notifications                 │
    │                             │──────────────────┬────────────────────┤
    │                             │                  │                    │
    │                             │                  ▼                    │
    │                             │         ┌──────────────┐              │
    │                             │         │    Twilio    │              │
    │                             │         │  (SMS/Voice) │              │
    │                             │         └──────────────┘              │
    │                             │                                       │
    │                             │ 8. Update Thread                      │
    │                             │ ┌─────────────────┐                   │
    │                             │ │ • Add Message   │                   │
    │                             │ │ • Update Summary│                   │
    │                             │ │ • Extract Tasks │                   │
    │                             │ └─────────────────┘                   │
    │                             │                                       │
    │                             │ 9. Log & Audit                        │
    │                             │──────────────────────────────────────▶│
    │                             │                                       │ Audit DB
    │                             │                                       │
```

---

## 12. Agentic Loop Integration

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                    EMAIL WORKFLOW IN 15 AGENTIC LOOPS                                        │
│                         OpenClaw AI Agent System                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 1: EMAIL MONITOR                                   │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Poll   │─▶│  Fetch  │─▶│  Parse  │─▶│ Enrich  │─▶│  Queue  │─▶│  Notify │─▶│  Wait   │ │
│  │ Gmail   │  │  Batch  │  │  MIME   │  │  (AI)   │  │  Email  │  │  Agent  │  │  Next   │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 2: RULE PROCESSOR                                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Dequeue│─▶│  Match  │─▶│  Score  │─▶│ Resolve │─▶│ Execute │─▶│  Log    │─▶│  Next   │ │
│  │  Email  │  │  Rules  │  │  Rules  │  │ Conflict│  │ Actions │  │  Result │  │  Email  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 3: AUTO-RESPONDER                                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Check  │─▶│  Match  │─▶│ Generate│─▶│  Queue  │─▶│  Send   │─▶│  Update │─▶│  Next   │ │
│  │  Trigger│  │ Template│  │ Response│  │  Delay  │  │  Email  │  │  History│  │  Check  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 4: THREAD TRACKER                                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│  Find   │─▶│  Match  │─▶│  Update │─▶│  AI     │─▶│  Save   │─▶│  Next   │ │
│  │  Email  │  │  Thread │  │  Fuzzy  │  │  Thread │  │  Summary│  │  State  │  │  Email  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 5: SCHEDULER                                       │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Check  │─▶│  Render │─▶│  Send   │─▶│  Update │─▶│  Resched│─▶│  Log    │─▶│  Wait   │ │
│  │  Jobs   │  │ Template│  │  Email  │  │  Status │  │  (if    │  │  Result │  │  Next   │ │
│  │         │  │         │  │         │  │         │  │recurring)│  │         │  │  Tick   │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 6: NOTIFICATION MANAGER                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│  Route  │─▶│ Format  │─▶│  Send   │─▶│ Confirm │─▶│  Log    │─▶│  Next   │ │
│  │  Notify │  │  Type   │  │ Message │  │  Notify │  │  Receipt│  │  Notify │  │  Notify │ │
│  │  Request│  │         │  │         │  │         │  │         │  │         │  │         │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 7: TEMPLATE ENGINE                                 │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│ Validate│─▶│  Apply  │─▶│  Render │─▶│  AI     │─▶│  Return │─▶│  Next   │ │
│  │  Render │  │  Vars   │  │ Defaults│  │ Template│  │ Enhance │  │  Result │  │  Render │ │
│  │  Request│  │         │  │         │  │         │  │(if enab)│  │         │  │         │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 8: SECURITY SCANNER                                │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│  Scan   │─▶│  Scan   │─▶│  Check  │─▶│  Apply  │─▶│  Log    │─▶│  Next   │ │
│  │  Email  │  │ Phishing│  │ Attach. │  │  Links  │  │ Actions │  │  Event  │  │  Email  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 9: ANALYTICS COLLECTOR                             │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Collect │─▶│  Parse  │─▶│ Aggregate│─▶│ Generate│─▶│  Store  │─▶│  Report │─▶│  Wait   │ │
│  │  Events │  │  Data   │  │  Metrics │  │  Report │  │  Report │  │  (opt)  │  │  Next   │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 10: AUDIT LOGGER                                   │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│  Format │─▶│  Filter │─▶│  Write  │─▶│  Rotate │─▶│  Archive│─▶│  Next   │ │
│  │  Event  │  │  Entry  │  │  Level  │  │  to Log │  │  (daily)│  │ (weekly)│  │  Event  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 11: WORKFLOW ORCHESTRATOR                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Trigger │─▶│  Load   │─▶│ Execute │─▶│  Handle │─▶│  Save   │─▶│  Notify │─▶│  Next   │ │
│  │ Workflow│  │  State  │  │  Nodes  │  │  Error  │  │  State  │  │  Result │  │  Trigger│ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 12: HEARTBEAT MONITOR                              │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Tick   │─▶│  Check  │─▶│  Check  │─▶│  Check  │─▶│  Alert  │─▶│  Log    │─▶│  Sleep  │ │
│  │         │  │  Gmail  │  │  Queue  │  │  Sched. │  │  (if    │  │  Status │  │  60s    │ │
│  │         │  │  Conn   │  │  Health │  │  Health │  │  needed)│  │         │  │         │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 13: CONVERSATION ANALYZER                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Check  │─▶│  Load   │─▶│  AI     │─▶│ Extract │─▶│  Update │─▶│  Notify │─▶│  Next   │ │
│  │  Thread │  │  Thread │  │  Analyze│  │  Tasks  │  │  Thread │  │  User   │  │  Thread │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 14: TASK EXTRACTOR                                 │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ Receive │─▶│  AI     │─▶│  Parse  │─▶│  Create │─▶│  Notify │─▶│  Log    │─▶│  Next   │ │
│  │  Email  │  │  Extract│  │  Tasks  │  │  Tasks  │  │  Assign.│  │  Tasks  │  │  Email  │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              AGENTIC LOOP 15: MAINTENANCE & CLEANUP                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │  Daily  │─▶│  Clean  │─▶│  Archive│─▶│  Purge  │─▶│  Update │─▶│  Report │─▶│  Wait   │ │
│  │  Trigger│  │  Old    │  │  Logs   │  │  Expired│  │  Stats  │  │  Status │  │  24h    │ │
│  │         │  │  Data   │  │         │  │  Data   │  │         │  │         │  │         │ │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

*End of Workflow Visualization Guide*
