{
  "loopId": "gmail-full-resync-loop-v1",
  "version": "1.0.0",
  "displayName": "Gmail Full Resync Loop",
  "description": "Executes full mailbox resync when history API returns 404 for stale/invalid startHistoryId pointers.",
  "ownerAgent": "gmail-integration-agent",
  "category": "integration-gmail",
  "tier": "A",
  "dependencyLayer": "integration",
  "priority": 55,
  "triggerTypes": [
    "event"
  ],
  "triggerClass": "event-triggered",
  "cadence": {
    "default": "event-driven"
  },
  "entryCriteria": [
    "gmail_history_api_returned_404_stale_history"
  ],
  "hardStops": [
    "budget_exhausted",
    "operator_abort",
    "gmail-full-resync-loop_critical_failure"
  ],
  "requiredContext": [
    "AGENTS.md",
    "integration-gmail_context"
  ],
  "thinkingPolicy": {
    "default": "medium",
    "escalateTo": "high",
    "escalateOn": [
      "auth_failure"
    ],
    "deescalateOn": [
      "budget_pressure"
    ]
  },
  "allowedTools": [
    "gmail.api",
    "memory.write",
    "config.read"
  ],
  "forbiddenTools": [
    "host.exec",
    "browser.navigate"
  ],
  "toolTierBudget": "tier-1",
  "approvalPoints": [],
  "approvalRequired": false,
  "maxSteps": 12,
  "maxDurationSec": 180,
  "riskTier": "safe",
  "successCriteria": [
    "full_mailbox_resync_completed_baseline_reset"
  ],
  "rollbackPlan": "Abort Gmail operation and log failure event.",
  "fallbackLoopChain": [
    "gmail-history-delta-sync-loop-v1"
  ],
  "terminationPolicy": "retry_then_escalate",
  "writebacks": {
    "memory": true,
    "logs": true,
    "actionArtifacts": true,
    "auditTrail": true
  },
  "outputContract": {
    "summaryRequired": true,
    "confidenceRequired": false,
    "evidenceRequired": false,
    "actionsRequired": true,
    "nextRequired": false
  },
  "loopLifecycleStates": [
    "queued",
    "preflight",
    "context-build",
    "reason",
    "act",
    "verify",
    "commit",
    "archive"
  ],
  "guardrails": {
    "confidenceThreshold": 0.5,
    "toolFailureBudget": 3,
    "sideEffectApprovalRequired": false
  },
  "composition": {
    "canBeCalledBy": [
      "ralph-loop-v1"
    ],
    "canCall": []
  }
}
