# Self-Updating Loop Configuration
# OpenClaw-Inspired AI Agent System - Windows 10 Edition

self_updating_loop:
  # Enable/disable the self-updating loop
  enabled: true
  
  # Check interval in seconds (default: 5 minutes)
  check_interval: 300
  
  # Update sources configuration
  sources:
    # File system monitoring
    filesystem:
      enabled: true
      watch_paths:
        - "./agents/"
        - "./loops/"
        - "./modules/"
        - "./skills/"
        - "./config/"
      ignore_patterns:
        - "__pycache__"
        - "*.pyc"
        - "*.pyo"
        - ".git"
        - "*.log"
        - "*.tmp"
    
    # Git repository monitoring
    git:
      enabled: true
      repository_path: "."
      remote_url: ""  # Set your remote repository URL
      ssh_key_path: ""  # Path to SSH key for authentication
      tracked_branches:
        - "main"
        - "develop"
        - "release/*"
      tracked_tags:
        - "v*"
    
    # Remote registry polling
    remote:
      enabled: false
      endpoint: ""  # Remote update registry endpoint
      api_key: ""  # API key for authentication
      poll_interval: 3600  # 1 hour
      channels:
        - "stable"
        - "beta"
  
  # Safety configuration
  safety:
    # Automatic update application by type
    auto_apply:
      patch: true      # Auto-apply patch updates
      minor: false     # Require approval for minor updates
      major: false     # Require approval for major updates
      hotfix: true     # Auto-apply hotfixes
      security: true   # Auto-apply security updates
      config: true     # Auto-apply configuration updates
    
    # Approval requirements
    require_approval_for:
      - "critical"     # Critical risk updates
      - "high"         # High risk updates
    
    # Backup settings
    backup_before_update: true
    backup_root: "./backups/"
    max_backups: 10
    
    # Testing settings
    test_before_apply: true
    test_timeout: 300  # 5 minutes
    
    # Resource requirements
    min_free_space_gb: 1.0
    min_free_memory_gb: 0.5
  
  # Rollback configuration
  rollback:
    auto_rollback_on_failure: true
    health_check_interval: 30  # seconds
    
    # Auto-rollback triggers
    triggers:
      health_check_failure:
        enabled: true
        threshold: 3  # consecutive failures
        window_seconds: 300
      error_rate_spike:
        enabled: true
        threshold: 0.1  # 10% error rate
        window_seconds: 120
      performance_degradation:
        enabled: true
        threshold: 1.5  # 50% slower
        window_seconds: 300
      service_unavailable:
        enabled: true
        threshold: 1
        window_seconds: 30
  
  # Version management
  versioning:
    scheme: "semver"  # semantic versioning
    version_file: "./version.json"
    changelog_file: "./CHANGELOG.md"
    
    # Git integration
    auto_tag_releases: true
    auto_push_tags: false  # Set to true for automatic push
  
  # Validation settings
  validation:
    enabled: true
    stages:
      - syntax
      - static_analysis
      - unit_tests
      - integration_tests
      - smoke_tests
    
    # Test thresholds
    coverage_threshold: 80
    max_test_duration: 600  # 10 minutes
  
  # Audit logging
  audit:
    enabled: true
    log_path: "./logs/updates/"
    log_level: "INFO"
    retention_days: 90
    archive_after_days: 30
    
    # Compliance
    maintain_chain_integrity: true
    export_format: "json"
  
  # Notification settings
  notifications:
    enabled: false
    channels:
      email:
        enabled: false
        smtp_server: ""
        smtp_port: 587
        username: ""
        password: ""
        recipients: []
      
      webhook:
        enabled: false
        url: ""
        events:
          - "update_completed"
          - "update_failed"
          - "rollback_completed"
      
      slack:
        enabled: false
        webhook_url: ""
        channel: ""

# Environment-specific overrides
environments:
  development:
    self_updating_loop:
      check_interval: 60
      safety:
        auto_apply:
          patch: true
          minor: true
          major: true
      
  staging:
    self_updating_loop:
      check_interval: 180
      safety:
        auto_apply:
          patch: true
          minor: true
          major: false
      
  production:
    self_updating_loop:
      check_interval: 600
      safety:
        auto_apply:
          patch: false
          minor: false
          major: false
        require_approval_for:
          - "low"
          - "medium"
          - "high"
          - "critical"
